#!/usr/bin/env bash

set -e

help() {
    echo ""
    echo "usage: $0 [image]"
    echo ""
    exit 1
}

VALID_IMAGE_NAME='^([a-z0-9]+(-[a-z0-9]+)*.)*[a-z0-9]+(:[0-9]*)?/[-:._a-zA-Z0-9]{0,62}[-:.a-zA-Z0-9]$'
# Sanity checks for injection attacks
if ! [[ $2 =~ $VALID_IMAGE_NAME ]] ; then
echo "error: Not an image name $3" >&2
	help
    fi

    if [[ "$(docker images -q $2 2> /dev/null)" == "" ]]; then
	exit 0
    else
	docker rmi -f $2
   fi

exit $?